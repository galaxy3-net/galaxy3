#!/usr/bin/env bash
#set -x


function state () {
  # echo "Checking the state" >&2
  echo $(vagrant status --machine-readable | egrep 'default,state' | grep -v "human" | awk -F, '{print $4}')
}

function up () {

  case "$(state)" in

    "running")
      printf "\n\t${boxname} is already running\n\n"
      ;;

    "poweroff" | "saved") vagrant ${*}
      ;;

    *) echo "state is $(state)"
      exit 1
      ;;
  esac
  return
}

function resume () {
  case "$(state)" in

    "saved")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

function halt () {
  case "$(state)" in

    "running")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

function suspend () {
  case "$(state)" in

    "running")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

function destroy () {
  case "$(state)" in

    "running")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}


export boxname=$(basename ${0})
echo " - - ${boxname} ${*} - -"

cd ${HOME}/galaxy3/vagrant/${boxname}

case "${1}" in

  "destroy") destroy ${*}
    ;;

  "up" | "resume")  up ${*}
    ;;

  "halt" | "suspend")  halt ${*}
    ;;

  "status") vagrant status
    ;;

   *)  echo "usage" ; exit 1
       ;;
esac

