#!/usr/bin/env bash
#set -x

[ "${VBOX_DIR:-notset}" == "notset" ] && export VBOX_DIR=""${HOME}/Virtualbox VMs/""
cat <<__EOD__

  Default Virtialbox VM Directory: ${


function state () {
  # echo "Checking the state" >&2
  echo $(vagrant status --machine-readable | egrep 'default,state' | grep -v "human" | awk -F, '{print $4}')
}

function up () {

  case "$(state)" in

    "running")
      printf "\n\t${boxname} is already running\n\n"
      ;;

    "poweroff" | "saved") vagrant ${*}
      ;;

    "not_created") vagrant ${*}
      ;;

    *) echo "state is $(state)"
      exit 1
      ;;
  esac
  return
}

function resume () {
  case "$(state)" in

    "saved")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

function halt () {
  case "$(state)" in

    "running")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

function suspend () {
  case "$(state)" in

    "running")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

function destroy () {
  case "$(state)" in

    "running")  vagrant ${*}
      ;;

    *) echo "state is $(state)"
       ;;
  esac
  return
}

#function dir_exists () {
#  cat <<__EOD__

#  While Vagrant's machine state is "not_created", the ${boxname}
#  directory already exists

#__EOD__

#}

function Virtualbox_VMs () {
  ls "${VBOX_DIR}" && return

  cat <<__EOD__

  Either Virtualbox is not installed or the default machine directory
  ${VBOX_DIR} has been changed.

__EOD__

  exit 1
}

export boxname=$(basename ${0})
echo " - - ${boxname} ${*} - -"

cd ${HOME}/galaxy3/vagrant/${boxname}
Virtualbox_VMs
exit
case "${1}" in

  "destroy") destroy ${*}
    ;;

  "up" | "resume")  up ${*}
    ;;

  "halt" | "suspend")  halt ${*}
    ;;

  "status") vagrant status
    ;;

   *)  echo "usage" ; exit 1
       ;;
esac

